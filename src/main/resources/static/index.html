<!DOCTYPE html>
<!--suppress HtmlFormInputWithoutLabel -->
<html lang="">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Chart.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>

    <!-- Jquery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <link rel="stylesheet" href="styles.css">
    <title>Scheduler</title>
</head>
<body>

<h2>Scheduler</h2>

<!--TRANSACTIONS LIST-->
<table class="myclass" id="orders">
    <thead>
    <tr>
        <th>Description</th>
        <th>Execution Date</th>
        <th>Amount</th>
        <th></th>
        <th></th>
        <th></th>
        <th style="font-size:0;">ID</th>
    </tr>
    </thead>
    <tbody>
    <tr style="background: #c7a800;">
        <td colspan="6"></td>
    </tr>
    </tbody>
</table>

<!--NEW SINGLE ORDER-->
<div style="overflow: hidden">
    <div style="padding: 10px"></div>                                                   <!-- SPACING -->
    <table class="myclass">
        <tr>
            <td style="padding: 5px"><h4>Enter new Single Order</h4></td>
            <td style="cursor: pointer; padding: 5px" id="clickme1"><img style="vertical-align:middle;" width="15px"
                                                                         alt="Plus" src="images/plus.svg"></td>
        </tr>
    </table>                                                          <!-- TITLE -->
    <div id="id12345" style="display:none; float: left; padding-bottom: 3px;">
        <table class="myclass">
            <thead>
            <tr>
                <th>Description</th>
                <th>Wire Transfer</th>
                <th>Day</th>
                <th>Month</th>
                <th>Year</th>
                <th>Amount</th>
                <th></th>
            </tr>
            </thead>
            <tbody>
            <tr id="singleordernew">
                <td style="padding-left: 10px; padding-right: 10px">
                    <div style="border: 2px solid #c7a800; ">
                        <input onkeyup="forgivedesc(this)" style="border: 0; padding-top: 3.2px; padding-bottom: 3.2px"
                               size="40" type="text" name="descr">
                    </div>
                </td>   <!-- Desc -->
                <td style="padding-left: 10px; padding-right: 10px">
                    <div style="border: 2px solid #c7a800;">
                        <select onchange="forgivewt(this)" name="wt" style="padding: 1.8px">
                            <option value="$">--Please Select--</option>
                            <option style="color : black" value="true">Yes</option>
                            <option style="color : black" value="false">No</option>
                        </select>
                    </div>
                </td>   <!-- WT -->
                <td style="padding-left: 10px; padding-right: 10px">
                    <div style="border: 2px solid #c7a800; ">
                        <select id="00" onchange="forgiveday(this)" style="padding: 1.8px" name="day">
                            <option value="$">--Please Select--</option>
                            <option style="color : black" value="1">1</option>
                            <option style="color : black" value="2">2</option>
                            <option style="color : black" value="3">3</option>
                            <option style="color : black" value="4">4</option>
                            <option style="color : black" value="5">5</option>
                            <option style="color : black" value="6">6</option>
                            <option style="color : black" value="7">7</option>
                            <option style="color : black" value="8">8</option>
                            <option style="color : black" value="9">9</option>
                            <option style="color : black" value="10">10</option>
                            <option style="color : black" value="11">11</option>
                            <option style="color : black" value="12">12</option>
                            <option style="color : black" value="13">13</option>
                            <option style="color : black" value="14">14</option>
                            <option style="color : black" value="15">15</option>
                            <option style="color : black" value="16">16</option>
                            <option style="color : black" value="17">17</option>
                            <option style="color : black" value="18">18</option>
                            <option style="color : black" value="19">19</option>
                            <option style="color : black" value="20">20</option>
                            <option style="color : black" value="21">21</option>
                            <option style="color : black" value="22">22</option>
                            <option style="color : black" value="23">23</option>
                            <option style="color : black" value="24">24</option>
                            <option style="color : black" value="25">25</option>
                            <option style="color : black" value="26">26</option>
                            <option style="color : black" value="27">27</option>
                            <option style="color : black" value="28">28</option>
                            <option style="color : black" value="29">29</option>
                            <option style="color : black" value="30">30</option>
                            <option style="color : black" value="31">31</option>
                        </select>
                    </div>
                </td>   <!-- Day -->
                <td style="padding-left: 10px; padding-right: 10px">
                    <div style="border: 2px solid #c7a800; ">
                        <select id="01" onchange="wrappermonth(this)" name="month" style="padding: 1.8px">
                            <option value="$">--Please Select--</option>
                            <option style="color : black" value="1">January</option>
                            <option style="color : black" value="2">February</option>
                            <option style="color : black" value="3">March</option>
                            <option style="color : black" value="4">April</option>
                            <option style="color : black" value="5">May</option>
                            <option style="color : black" value="6">June</option>
                            <option style="color : black" value="7">July</option>
                            <option style="color : black" value="8">August</option>
                            <option style="color : black" value="9">September</option>
                            <option style="color : black" value="10">October</option>
                            <option style="color : black" value="11">November</option>
                            <option style="color : black" value="12">December</option>
                        </select>
                    </div>
                </td>   <!-- Month -->
                <td style="padding-left: 10px; padding-right: 10px">
                    <div style="border: 2px solid #c7a800; ">
                        <input id="02" dirname="" onkeydown="setprev(this)" oninput="wrapperyear(this)"
                               style="border: 0; padding-top: 3.2px; padding-bottom: 3.2px"
                               type="text" name="year" size="3">
                    </div>
                </td>   <!-- Year -->
                <td style="padding-left: 10px; padding-right: 10px">
                    <div style="border: 2px solid #c7a800; ">
                        <input dirname="" onkeydown="setprev(this)" oninput="wrapperamount(this)"
                               style="border: 0; padding-top: 3.2px; padding-bottom: 3.2px"
                               type="text" name="amount" size="10">
                    </div>
                </td>   <!-- Amount -->
                <td>
                    <img onclick="addnews()" style="cursor: pointer; vertical-align:middle;" width="20px" alt="Plus"
                         src="images/plus.svg">
                </td>                                                   <!-- Button add -->
            </tr>
            </tbody>
        </table>
    </div>       <!-- ACTUAL CONTENT -->
    <hr id="l111" style="border: 2px solid #c7a800; float: left"/>                   <!-- LINE UNDERNEATH -->
</div>

<!-- SPACING -->
<div style="margin: 40px"></div>

<!--NEW REPEATED ORDER-->
<div id="repeatedordernew" style="overflow: hidden">
    <table class="myclass">
        <tr>
            <td style="padding: 5px"><h4>Enter new Repeated Order</h4></td>
            <td style="cursor: pointer; padding: 5px" id="clickme2"><img style="vertical-align:middle;" width="15px"
                                                                         alt="No" src="images/plus.svg"></td>
        </tr>
    </table>
    <div id="id12346" style="display:none; float: left; padding-bottom: 3px;">
        <table class="myclass">
            <thead>
            <tr>
                <th></th>
                <th></th>
            </tr>
            <tr>
                <th>Description</th>
                <th>Wire Transfer</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td style="padding-left: 10px; padding-right: 10px">
                    <div style="border: 2px solid #c7a800; ">
                        <input onkeyup="forgivedesc(this)" style="border: 0; padding-top: 3.2px; padding-bottom: 3.2px"
                               size="40" type="text" name="descr">
                    </div>
                </td>   <!-- Desc -->
                <td style="padding-left: 10px; padding-right: 10px">
                    <div style="border: 2px solid #c7a800;">
                        <select onchange="forgivewt(this)" name="wt" style="padding: 1.8px">
                            <option value="$">--Please Select--</option>
                            <option style="color : black" value="true">Yes</option>
                            <option style="color : black" value="false">No</option>
                        </select>
                    </div>
                </td>   <!-- WT -->
            </tr>
            </tbody>
        </table>
        <!-- SPACING -->
        <div style="margin: 20px"></div>
        <table class="myclass">
            <thead>
            <tr>
                <th style="border-bottom: 2px solid #c7a800; text-align: center" colspan="3">Frequency</th>
                <th></th>
                <th></th>
            </tr>
            <tr>
                <th>Length</th>
                <th>Range</th>
                <th>Options</th>
                <th>Month</th>
                <th>Day</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td style="margin-left: 20px; padding-right: 10px">
                    <div style="border: 2px solid #c7a800; ">
                        <input style="border: 0; padding-top: 3.2px; padding-bottom: 3.2px" id="f1" name="f1" size="3"
                               dirname="" type=text onkeydown="setprev(this)" oninput="wrapperf1(this)">
                    </div>
                </td>   <!-- F1 -->
                <td style="margin-left: 20px; padding-right: 8px">
                    <div style="border: 2px solid #c7a800;">
                        <select onchange="forgivef2(this)" style="padding: 1.8px" id="f2" name="f2">
                            <option value="$">--Please Select--</option>
                            <option style="color : black" value="days">Days</option>
                            <option style="color : black" value="months">Months</option>
                            <option style="color : black" value="years">Years</option>
                        </select>
                    </div>
                </td>     <!-- F2 -->
                <td style="margin-left: 20px; padding-right: 8px">
                    <div style="border: 2px solid #c7a800;">
                        <select onchange="adaptdate(this)" style="padding: 1.8px" id="1k" name="opt1">
                            <option style="color : black" value="default">Specific day</option>
                            <option style="color : black" value="eom">End of month</option>
                            <option style="color : black" value="eoy">End of year</option>
                        </select>
                    </div>
                </td>     <!-- OPTIONS -->
                <td style="border-spacing: 20px; padding-right: 10px">
                    <div style="border: 2px solid #c7a800; ">
                        <select id="10" onchange="forgiveday(this)" style="padding: 1.8px" name="day1">
                            <option value="$">--Please Select--</option>
                            <option style="color : black" value="1">1</option>
                            <option style="color : black" value="2">2</option>
                            <option style="color : black" value="3">3</option>
                            <option style="color : black" value="4">4</option>
                            <option style="color : black" value="5">5</option>
                            <option style="color : black" value="6">6</option>
                            <option style="color : black" value="7">7</option>
                            <option style="color : black" value="8">8</option>
                            <option style="color : black" value="9">9</option>
                            <option style="color : black" value="10">10</option>
                            <option style="color : black" value="11">11</option>
                            <option style="color : black" value="12">12</option>
                            <option style="color : black" value="13">13</option>
                            <option style="color : black" value="14">14</option>
                            <option style="color : black" value="15">15</option>
                            <option style="color : black" value="16">16</option>
                            <option style="color : black" value="17">17</option>
                            <option style="color : black" value="18">18</option>
                            <option style="color : black" value="19">19</option>
                            <option style="color : black" value="20">20</option>
                            <option style="color : black" value="21">21</option>
                            <option style="color : black" value="22">22</option>
                            <option style="color : black" value="23">23</option>
                            <option style="color : black" value="24">24</option>
                            <option style="color : black" value="25">25</option>
                            <option style="color : black" value="26">26</option>
                            <option style="color : black" value="27">27</option>
                            <option style="color : black" value="28">28</option>
                            <option style="color : black" value="29">29</option>
                            <option style="color : black" value="30">30</option>
                            <option style="color : black" value="31">31</option>
                        </select>
                    </div>
                </td>   <!-- Day -->
                <td style="margin-left: 20px; padding-right: 10px">
                    <div style="border: 2px solid #c7a800; ">
                        <select id="11" onchange="wrappermonth(this)" name="month1" style="padding: 1.8px">
                            <option value="$">--Please Select--</option>
                            <option style="color : black" value="1">January</option>
                            <option style="color : black" value="2">February</option>
                            <option style="color : black" value="3">March</option>
                            <option style="color : black" value="4">April</option>
                            <option style="color : black" value="5">May</option>
                            <option style="color : black" value="6">June</option>
                            <option style="color : black" value="7">July</option>
                            <option style="color : black" value="8">August</option>
                            <option style="color : black" value="9">September</option>
                            <option style="color : black" value="10">October</option>
                            <option style="color : black" value="11">November</option>
                            <option style="color : black" value="12">December</option>
                        </select>
                    </div>
                </td>   <!-- Month -->
            </tr>
            </tbody>
        </table>
        <!-- SPACING -->
        <div style="margin: 20px"></div>
        <table class="myclass">
            <thead>
            <tr>
                <th style="border-bottom: 2px solid #c7a800; text-align: center" colspan="4">Initial Date</th>
                <th style="border-bottom: 2px solid #c7a800; text-align: center" colspan="4">Final Date</th>
                <th style="font-size:0;"></th>
                <th style="font-size:0;"></th>
            </tr>
            <tr>
                <th>Options</th>
                <th>Day</th>
                <th>Month</th>
                <th>Year</th>
                <th>Options</th>
                <th>Day</th>
                <th>Month</th>
                <th>Year</th>
                <th>Amount</th>
                <th></th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td style="padding-left: 8px; padding-right: 8px">
                    <div style="border: 2px solid #c7a800;">
                        <select onchange="adaptdate(this)" style="padding: 1.8px" id="1k" name="opt1">
                            <option style="color : black" value="default">Specific day</option>
                            <option style="color : black" value="eom">End of month</option>
                            <option style="color : black" value="eoy">End of year</option>
                        </select>
                    </div>
                </td>     <!-- OPTIONS -->
                <td style="padding-left: 10px; padding-right: 10px">
                    <div style="border: 2px solid #c7a800; ">
                        <select id="10" onchange="forgiveday(this)" style="padding: 1.8px" name="day1">
                            <option value="$">--Please Select--</option>
                            <option style="color : black" value="1">1</option>
                            <option style="color : black" value="2">2</option>
                            <option style="color : black" value="3">3</option>
                            <option style="color : black" value="4">4</option>
                            <option style="color : black" value="5">5</option>
                            <option style="color : black" value="6">6</option>
                            <option style="color : black" value="7">7</option>
                            <option style="color : black" value="8">8</option>
                            <option style="color : black" value="9">9</option>
                            <option style="color : black" value="10">10</option>
                            <option style="color : black" value="11">11</option>
                            <option style="color : black" value="12">12</option>
                            <option style="color : black" value="13">13</option>
                            <option style="color : black" value="14">14</option>
                            <option style="color : black" value="15">15</option>
                            <option style="color : black" value="16">16</option>
                            <option style="color : black" value="17">17</option>
                            <option style="color : black" value="18">18</option>
                            <option style="color : black" value="19">19</option>
                            <option style="color : black" value="20">20</option>
                            <option style="color : black" value="21">21</option>
                            <option style="color : black" value="22">22</option>
                            <option style="color : black" value="23">23</option>
                            <option style="color : black" value="24">24</option>
                            <option style="color : black" value="25">25</option>
                            <option style="color : black" value="26">26</option>
                            <option style="color : black" value="27">27</option>
                            <option style="color : black" value="28">28</option>
                            <option style="color : black" value="29">29</option>
                            <option style="color : black" value="30">30</option>
                            <option style="color : black" value="31">31</option>
                        </select>
                    </div>
                </td>   <!-- Day -->
                <td style="padding-left: 10px; padding-right: 10px">
                    <div style="border: 2px solid #c7a800; ">
                        <select id="11" onchange="wrappermonth(this)" name="month1" style="padding: 1.8px">
                            <option value="$">--Please Select--</option>
                            <option style="color : black" value="1">January</option>
                            <option style="color : black" value="2">February</option>
                            <option style="color : black" value="3">March</option>
                            <option style="color : black" value="4">April</option>
                            <option style="color : black" value="5">May</option>
                            <option style="color : black" value="6">June</option>
                            <option style="color : black" value="7">July</option>
                            <option style="color : black" value="8">August</option>
                            <option style="color : black" value="9">September</option>
                            <option style="color : black" value="10">October</option>
                            <option style="color : black" value="11">November</option>
                            <option style="color : black" value="12">December</option>
                        </select>
                    </div>
                </td>   <!-- Month -->
                <td style="padding-left: 10px; padding-right: 10px">
                    <div style="border: 2px solid #c7a800; ">
                        <input id="12" dirname="" onkeydown="setprev(this)" oninput="wrapperyear(this)"
                               style="border: 0; padding-top: 3.2px; padding-bottom: 3.2px"
                               type="text" name="year1" size="3">
                    </div>
                </td>   <!-- Year -->
                <td style="padding-left: 8px; padding-right: 8px">
                    <div style="border: 2px solid #c7a800;">
                        <select onchange="adaptdate(this)" style="padding: 1.8px" id="2k" name="opt2">
                            <option style="color : black" value="default">Specific day</option>
                            <option style="color : black" value="eom">End of month</option>
                            <option style="color : black" value="eoy">End of year</option>
                        </select>
                    </div>
                </td>     <!-- OPTIONS -->
                <td style="padding-left: 10px; padding-right: 10px">
                    <div style="border: 2px solid #c7a800; ">
                        <select id="20" onchange="forgiveday(this)" style="padding: 1.8px" name="day2">
                            <option value="$">--Please Select--</option>
                            <option style="color : black" value="1">1</option>
                            <option style="color : black" value="2">2</option>
                            <option style="color : black" value="3">3</option>
                            <option style="color : black" value="4">4</option>
                            <option style="color : black" value="5">5</option>
                            <option style="color : black" value="6">6</option>
                            <option style="color : black" value="7">7</option>
                            <option style="color : black" value="8">8</option>
                            <option style="color : black" value="9">9</option>
                            <option style="color : black" value="10">10</option>
                            <option style="color : black" value="11">11</option>
                            <option style="color : black" value="12">12</option>
                            <option style="color : black" value="13">13</option>
                            <option style="color : black" value="14">14</option>
                            <option style="color : black" value="15">15</option>
                            <option style="color : black" value="16">16</option>
                            <option style="color : black" value="17">17</option>
                            <option style="color : black" value="18">18</option>
                            <option style="color : black" value="19">19</option>
                            <option style="color : black" value="20">20</option>
                            <option style="color : black" value="21">21</option>
                            <option style="color : black" value="22">22</option>
                            <option style="color : black" value="23">23</option>
                            <option style="color : black" value="24">24</option>
                            <option style="color : black" value="25">25</option>
                            <option style="color : black" value="26">26</option>
                            <option style="color : black" value="27">27</option>
                            <option style="color : black" value="28">28</option>
                            <option style="color : black" value="29">29</option>
                            <option style="color : black" value="30">30</option>
                            <option style="color : black" value="31">31</option>
                        </select>
                    </div>
                </td>   <!-- Day -->
                <td style="padding-left: 10px; padding-right: 10px">
                    <div style="border: 2px solid #c7a800; ">
                        <select id="21" onchange="wrappermonth(this)" name="month2" style="padding: 1.8px">
                            <option value="$">--Please Select--</option>
                            <option style="color : black" value="1">January</option>
                            <option style="color : black" value="2">February</option>
                            <option style="color : black" value="3">March</option>
                            <option style="color : black" value="4">April</option>
                            <option style="color : black" value="5">May</option>
                            <option style="color : black" value="6">June</option>
                            <option style="color : black" value="7">July</option>
                            <option style="color : black" value="8">August</option>
                            <option style="color : black" value="9">September</option>
                            <option style="color : black" value="10">October</option>
                            <option style="color : black" value="11">November</option>
                            <option style="color : black" value="12">December</option>
                        </select>
                    </div>
                </td>   <!-- Month -->
                <td style="padding-left: 10px; padding-right: 10px">
                    <div style="border: 2px solid #c7a800; ">
                        <input id="22" dirname="" onkeydown="setprev(this)" oninput="wrapperyear(this)"
                               style="border: 0; padding-top: 3.2px; padding-bottom: 3.2px"
                               type="text" name="year2" size="3">
                    </div>
                </td>   <!-- Year -->
                <td style="padding-left: 10px; padding-right: 10px">
                    <div style="border: 2px solid #c7a800; ">
                        <input dirname="" onkeydown="setprev(this)" oninput="wrapperamount(this)"
                               style="border: 0; padding-top: 3.2px; padding-bottom: 3.2px"
                               type="text" name="amount" id="amount2" size="10">
                    </div>
                </td>   <!-- Amount -->
                <td>
                    <img onclick="addnewr()" style="cursor: pointer; vertical-align:middle;" width="20px" alt="Plus"
                         src="images/plus.svg">
                </td>                                                   <!-- Button add -->
            </tr>
            </tbody>
        </table>
    </div>
    <hr id="l222" style="border: 2px solid #c7a800; float: left"/>
</div>

<!-- SPACING -->
<div style="padding: 20px"></div>

<table class="myclass">
    <tr>
        <td style="padding: 0; margin: 0">Preview until:</td>
        <td>
            <div>
                <input style="text-align: center; background-color: #383737; color: #c7a800; outline: none; border: 0;"
                       type="text" id="previewenddate" size="10" value="31.12.2022">
            </div>
        </td>
        <td style="padding: 0 0 0 50px;">Initial balance:</td>
        <td>
            <div>
                <input style="text-align: center; background-color: #383737; color: #c7a800; outline: none; border: 0;"
                       type="text" id="initalbalance" size="10" value="150.00">
            </div>
        </td>
        <td onclick="populate2()" style="cursor: pointer; padding:0" id="reload"><img
                style="vertical-align:middle;" width="20px" alt="Releoad picture" src="images/reload.svg"></td>
    </tr>
</table>
<!-- SPACING -->
<div style="padding: 10px"></div>
<table id="preview" class="myclass">
    <thead>
    <tr>
        <!--  <th scope="col">#</th> -->
        <th scope="col">Description</th>
        <th scope="col">Planned date</th>
        <th scope="col">Execution date</th>
        <th scope="col">Amount</th>
        <th scope="col">Balance</th>
        <th scope="col">Inspection</th>
    </tr>
    </thead>
    <tbody>
    </tbody>
</table>

<div style="page-break-inside:avoid;page-break-after:always">
</div>

<canvas id="myChart" style="width:100%;max-width:100%"></canvas>
<canvas id="myChart2" style="width:100%;max-width:100%"></canvas>

<div style="page-break-inside:avoid;page-break-after:always">
</div>


<a onclick="haltprocessor()">Stop</a>
<!-- HERE BELOW IT IS ALWAYS UPDATED THE FULL SCHEDULE-->


</body>

<!-- FUNCTIONS  -->
<script>
    function populate1() {
        $.post("/orders", function (returnedData) {

            let i;
            if (returnedData === "")
                return;

            let el = $("#orders tbody");
            el.empty();
            el.append("        <tr style=\"background: #c7a800;\">\n" +
                "            <td colspan=\"6\"></td>\n" +
                "        </tr>");


            let lines = returnedData.split("\n");

            for (i = 0; i < lines.length - 1; i++) {
                data = JSON.parse(lines[i])
                el.append("        <tr id='" + data.id + "'>\n" +
                    "            <td>" + data.descr + "</td>\n" +
                    "            <td style = 'text-align: right'><div class=\"animate\">Loading</div></td>\n" +
                    "            <td style = 'text-align: right'>" + data.amount + "</td>\n" +
                    "            <td onclick='duplicate(" + data.id + ")' style=\"cursor: pointer; padding: 5px\"><img style=\"vertical-align:middle;\" width=\"15px\"\n" +
                    "                                                           alt=\"No\" src=\"images/plus.svg\"></td>\n" +
                    "            <td style=\"cursor: pointer; padding: 5px\"><img style=\"vertical-align:middle;\" width=\"15px\"\n" +
                    "                                                           alt=\"No\" src=\"images/pencil.svg\"></td>\n" +
                    "            <td onclick='_delete(" + data.id + ")' style=\"cursor: pointer; padding: 5px\"><img style=\"vertical-align:middle;\" width=\"15px\"\n" +
                    "                                                           alt=\"No\" src=\"images/bin.svg\"></td>\n" +
                    "            <td style=\"font-size:0;\">" + "" + "</td>\n" +
                    "        </tr>"
                )
            }

            i = 0;
            el.find("tr").each(function () {
                let ell = $(this).children();
                if (ell.length > 1) {
                    $.post("/schedule", {data: lines[i]}, function (returnedData) {
                        ell[1].removeChild(ell[1].firstChild)
                        ell[1].append(returnedData)
                    })
                    i++;
                }
            });
        }).fail(function () {
            console.log("error")
        })
    }

    function populate2() {
        $.post("/preview", {data: $("#previewenddate").val() + "\n" + $("#initalbalance").val()}, function (returnedData) {
            $("#preview tbody").empty();
            $("#preview tbody").append(returnedData);
        }).fail(function () {
            console.log("error")
        })
    }

    function chart1() {
        const ctx = document.getElementById('myChart');
        const myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Sun, 06 Mar. 22', 'Mon, 07 Mar. 22', 'Tue, 08 Mar. 22', 'Wed, 09 Mar. 22', 'Thu, 10 Mar. 22', 'Fri, 11 Mar. 22', 'Sat, 12 Mar. 22', 'Sun, 13 Mar. 22', 'Mon, 14 Mar. 22', 'Tue, 15 Mar. 22', 'Wed, 16 Mar. 22', 'Thu, 17 Mar. 22', 'Fri, 18 Mar. 22', 'Sat, 19 Mar. 22', 'Sun, 20 Mar. 22', 'Mon, 21 Mar. 22', 'Tue, 22 Mar. 22', 'Wed, 23 Mar. 22', 'Thu, 24 Mar. 22', 'Fri, 25 Mar. 22', 'Sat, 26 Mar. 22', 'Sun, 27 Mar. 22', 'Mon, 28 Mar. 22', 'Tue, 29 Mar. 22', 'Wed, 30 Mar. 22', 'Thu, 31 Mar. 22', 'Fri, 01 Apr. 22', 'Sat, 02 Apr. 22', 'Sun, 03 Apr. 22', 'Mon, 04 Apr. 22', 'Tue, 05 Apr. 22', 'Wed, 06 Apr. 22', 'Thu, 07 Apr. 22', 'Fri, 08 Apr. 22', 'Sat, 09 Apr. 22', 'Sun, 10 Apr. 22', 'Mon, 11 Apr. 22', 'Tue, 12 Apr. 22', 'Wed, 13 Apr. 22', 'Thu, 14 Apr. 22', 'Fri, 15 Apr. 22', 'Sat, 16 Apr. 22', 'Sun, 17 Apr. 22', 'Mon, 18 Apr. 22', 'Tue, 19 Apr. 22', 'Wed, 20 Apr. 22', 'Thu, 21 Apr. 22', 'Fri, 22 Apr. 22', 'Sat, 23 Apr. 22', 'Sun, 24 Apr. 22', 'Mon, 25 Apr. 22', 'Tue, 26 Apr. 22', 'Wed, 27 Apr. 22', 'Thu, 28 Apr. 22', 'Fri, 29 Apr. 22', 'Sat, 30 Apr. 22', 'Sun, 01 May. 22', 'Mon, 02 May. 22', 'Tue, 03 May. 22', 'Wed, 04 May. 22', 'Thu, 05 May. 22', 'Fri, 06 May. 22', 'Sat, 07 May. 22', 'Sun, 08 May. 22', 'Mon, 09 May. 22', 'Tue, 10 May. 22', 'Wed, 11 May. 22', 'Thu, 12 May. 22', 'Fri, 13 May. 22', 'Sat, 14 May. 22', 'Sun, 15 May. 22', 'Mon, 16 May. 22', 'Tue, 17 May. 22', 'Wed, 18 May. 22', 'Thu, 19 May. 22', 'Fri, 20 May. 22', 'Sat, 21 May. 22', 'Sun, 22 May. 22', 'Mon, 23 May. 22', 'Tue, 24 May. 22', 'Wed, 25 May. 22', 'Thu, 26 May. 22', 'Fri, 27 May. 22', 'Sat, 28 May. 22', 'Sun, 29 May. 22', 'Mon, 30 May. 22', 'Tue, 31 May. 22', 'Wed, 01 Jun. 22', 'Thu, 02 Jun. 22', 'Fri, 03 Jun. 22', 'Sat, 04 Jun. 22', 'Sun, 05 Jun. 22', 'Mon, 06 Jun. 22', 'Tue, 07 Jun. 22', 'Wed, 08 Jun. 22', 'Thu, 09 Jun. 22', 'Fri, 10 Jun. 22', 'Sat, 11 Jun. 22', 'Sun, 12 Jun. 22', 'Mon, 13 Jun. 22', 'Tue, 14 Jun. 22', 'Wed, 15 Jun. 22', 'Thu, 16 Jun. 22', 'Fri, 17 Jun. 22', 'Sat, 18 Jun. 22', 'Sun, 19 Jun. 22', 'Mon, 20 Jun. 22', 'Tue, 21 Jun. 22', 'Wed, 22 Jun. 22', 'Thu, 23 Jun. 22', 'Fri, 24 Jun. 22', 'Sat, 25 Jun. 22', 'Sun, 26 Jun. 22', 'Mon, 27 Jun. 22', 'Tue, 28 Jun. 22', 'Wed, 29 Jun. 22', 'Thu, 30 Jun. 22', 'Fri, 01 Jul. 22', 'Sat, 02 Jul. 22', 'Sun, 03 Jul. 22', 'Mon, 04 Jul. 22', 'Tue, 05 Jul. 22', 'Wed, 06 Jul. 22', 'Thu, 07 Jul. 22', 'Fri, 08 Jul. 22', 'Sat, 09 Jul. 22', 'Sun, 10 Jul. 22', 'Mon, 11 Jul. 22', 'Tue, 12 Jul. 22', 'Wed, 13 Jul. 22', 'Thu, 14 Jul. 22', 'Fri, 15 Jul. 22', 'Sat, 16 Jul. 22', 'Sun, 17 Jul. 22', 'Mon, 18 Jul. 22', 'Tue, 19 Jul. 22', 'Wed, 20 Jul. 22', 'Thu, 21 Jul. 22', 'Fri, 22 Jul. 22', 'Sat, 23 Jul. 22', 'Sun, 24 Jul. 22', 'Mon, 25 Jul. 22', 'Tue, 26 Jul. 22', 'Wed, 27 Jul. 22', 'Thu, 28 Jul. 22', 'Fri, 29 Jul. 22', 'Sat, 30 Jul. 22', 'Sun, 31 Jul. 22', 'Mon, 01 Aug. 22', 'Tue, 02 Aug. 22', 'Wed, 03 Aug. 22', 'Thu, 04 Aug. 22', 'Fri, 05 Aug. 22', 'Sat, 06 Aug. 22', 'Sun, 07 Aug. 22', 'Mon, 08 Aug. 22', 'Tue, 09 Aug. 22', 'Wed, 10 Aug. 22', 'Thu, 11 Aug. 22', 'Fri, 12 Aug. 22', 'Sat, 13 Aug. 22', 'Sun, 14 Aug. 22', 'Mon, 15 Aug. 22', 'Tue, 16 Aug. 22', 'Wed, 17 Aug. 22', 'Thu, 18 Aug. 22', 'Fri, 19 Aug. 22', 'Sat, 20 Aug. 22', 'Sun, 21 Aug. 22', 'Mon, 22 Aug. 22', 'Tue, 23 Aug. 22', 'Wed, 24 Aug. 22', 'Thu, 25 Aug. 22', 'Fri, 26 Aug. 22', 'Sat, 27 Aug. 22', 'Sun, 28 Aug. 22', 'Mon, 29 Aug. 22', 'Tue, 30 Aug. 22', 'Wed, 31 Aug. 22', 'Thu, 01 Sep. 22', 'Fri, 02 Sep. 22', 'Sat, 03 Sep. 22', 'Sun, 04 Sep. 22', 'Mon, 05 Sep. 22', 'Tue, 06 Sep. 22', 'Wed, 07 Sep. 22', 'Thu, 08 Sep. 22', 'Fri, 09 Sep. 22', 'Sat, 10 Sep. 22', 'Sun, 11 Sep. 22', 'Mon, 12 Sep. 22', 'Tue, 13 Sep. 22', 'Wed, 14 Sep. 22', 'Thu, 15 Sep. 22', 'Fri, 16 Sep. 22', 'Sat, 17 Sep. 22', 'Sun, 18 Sep. 22', 'Mon, 19 Sep. 22', 'Tue, 20 Sep. 22', 'Wed, 21 Sep. 22', 'Thu, 22 Sep. 22', 'Fri, 23 Sep. 22', 'Sat, 24 Sep. 22', 'Sun, 25 Sep. 22', 'Mon, 26 Sep. 22', 'Tue, 27 Sep. 22', 'Wed, 28 Sep. 22', 'Thu, 29 Sep. 22', 'Fri, 30 Sep. 22', 'Sat, 01 Oct. 22', 'Sun, 02 Oct. 22', 'Mon, 03 Oct. 22', 'Tue, 04 Oct. 22', 'Wed, 05 Oct. 22', 'Thu, 06 Oct. 22', 'Fri, 07 Oct. 22', 'Sat, 08 Oct. 22', 'Sun, 09 Oct. 22', 'Mon, 10 Oct. 22', 'Tue, 11 Oct. 22', 'Wed, 12 Oct. 22', 'Thu, 13 Oct. 22', 'Fri, 14 Oct. 22', 'Sat, 15 Oct. 22', 'Sun, 16 Oct. 22', 'Mon, 17 Oct. 22', 'Tue, 18 Oct. 22', 'Wed, 19 Oct. 22', 'Thu, 20 Oct. 22', 'Fri, 21 Oct. 22', 'Sat, 22 Oct. 22', 'Sun, 23 Oct. 22', 'Mon, 24 Oct. 22', 'Tue, 25 Oct. 22', 'Wed, 26 Oct. 22', 'Thu, 27 Oct. 22', 'Fri, 28 Oct. 22', 'Sat, 29 Oct. 22', 'Sun, 30 Oct. 22', 'Mon, 31 Oct. 22', 'Tue, 01 Nov. 22', 'Wed, 02 Nov. 22', 'Thu, 03 Nov. 22', 'Fri, 04 Nov. 22', 'Sat, 05 Nov. 22', 'Sun, 06 Nov. 22', 'Mon, 07 Nov. 22', 'Tue, 08 Nov. 22', 'Wed, 09 Nov. 22', 'Thu, 10 Nov. 22', 'Fri, 11 Nov. 22', 'Sat, 12 Nov. 22', 'Sun, 13 Nov. 22', 'Mon, 14 Nov. 22', 'Tue, 15 Nov. 22', 'Wed, 16 Nov. 22', 'Thu, 17 Nov. 22', 'Fri, 18 Nov. 22', 'Sat, 19 Nov. 22', 'Sun, 20 Nov. 22', 'Mon, 21 Nov. 22', 'Tue, 22 Nov. 22', 'Wed, 23 Nov. 22', 'Thu, 24 Nov. 22', 'Fri, 25 Nov. 22', 'Sat, 26 Nov. 22', 'Sun, 27 Nov. 22', 'Mon, 28 Nov. 22', 'Tue, 29 Nov. 22', 'Wed, 30 Nov. 22', 'Thu, 01 Dec. 22', 'Fri, 02 Dec. 22', 'Sat, 03 Dec. 22', 'Sun, 04 Dec. 22', 'Mon, 05 Dec. 22', 'Tue, 06 Dec. 22', 'Wed, 07 Dec. 22', 'Thu, 08 Dec. 22', 'Fri, 09 Dec. 22', 'Sat, 10 Dec. 22', 'Sun, 11 Dec. 22', 'Mon, 12 Dec. 22', 'Tue, 13 Dec. 22', 'Wed, 14 Dec. 22', 'Thu, 15 Dec. 22', 'Fri, 16 Dec. 22', 'Sat, 17 Dec. 22', 'Sun, 18 Dec. 22', 'Mon, 19 Dec. 22', 'Tue, 20 Dec. 22', 'Wed, 21 Dec. 22', 'Thu, 22 Dec. 22', 'Fri, 23 Dec. 22', 'Sat, 24 Dec. 22', 'Sun, 25 Dec. 22', 'Mon, 26 Dec. 22', 'Tue, 27 Dec. 22', 'Wed, 28 Dec. 22', 'Thu, 29 Dec. 22', 'Fri, 30 Dec. 22', 'Sat, 31 Dec. 22', 'Sun, 01 Jan. 23', 'Mon, 02 Jan. 23',],
                datasets: [{
                    label: 'Balance',
                    data: ['1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000',],
                    backgroundColor: 'rgba(255, 206, 86, 0.2)',
                    borderColor: 'rgba(255, 206, 86, 1)',
                    borderWidth: 1
                },
                    {
                        label: 'Interpolation',
                        data: ['1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000', '1386.770000',],
                        borderColor: "orange",
                        fill: false,
                        borderWidth: 2
                    }
                ]
            },
            options: {
                elements: {
                    point: {
                        radius: 0
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    }

    function chart2() {
        const ctx2 = document.getElementById('myChart2');
        const myChart2 = new Chart(ctx2, {
            type: 'line',
            data: {
                labels: [],
                datasets: [{
                    label: 'Transactions',
                    data: [],
                    borderColor: "orange",
                    backgroundColor: 'rgba(255, 206, 86, 0.2)',
                    fill: false,
                    borderWidth: 1,
                    stack: 'combined',
                    type: 'bar'
                }, {
                    label: 'Balances',
                    data: [],
                    borderColor: "violet",
                    fill: false,
                    borderWidth: 1
                }
                ]
            },
            options: {
                elements: {
                    point: {
                        radius: 1.5
                    }
                }, scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    }
</script>

<!-- INITIALIZER SCRIPT-->
<script>
    $("#l111").attr("width", $("#id12345").width())
    $("#l222").attr("width", $("#id12346").width())
    populate1();
    populate2();
    chart1();
    chart2();

</script>


<!-- SLIDESHOW SCRIPTS-->
<script>
    $("#clickme1").click(function () {
        let sel = $("#id12345");
        if (!sel.is(':visible')) {
            sel.slideDown(1500, function () {
                $("#clickme1").children().attr("src", "images/minus.png")
            });
        } else {
            sel.slideUp(1500, function () {
                $("#clickme1").children().attr("src", "images/plus.svg")
            });
        }
    });

    $("#clickme2").click(function () {
        let sel = $("#id12346");
        if (!sel.is(':visible')) {
            sel.slideDown(1500, function () {
                $("#clickme2").children().attr("src", "images/minus.png")
            });
        } else {
            sel.slideUp(1500, function () {
                $("#clickme2").children().attr("src", "images/plus.svg")
            });
        }
    });
</script>


<!-- FUNCTIONS -->
<script>

    function setprev(k) {
        k.dirName = JSON.stringify([k.value, k.selectionEnd, k.selectionEnd]);
    }

    function preparetosend(k) {
        return {
            descr: k.find("[name = descr]").val(),
            wt: k.find("[name = wt] :selected").val(),
            f1: k.find("[name = f1]").val(),
            f2: k.find("[name = f2] :selected").val(),
            day: k.find("[name = day] :selected").val(),
            month: k.find("[name = month] :selected").val(),
            year: k.find("[name = year]").val(),
            opt1: k.find("[name = opt1] :selected").val(),
            day1: k.find("[name = day1] :selected").val(),
            month1: k.find("[name = month1] :selected").val(),
            year1: k.find("[name = year1]").val(),
            opt2: k.find("[name = opt2] :selected").val(),
            day2: k.find("[name = day2] :selected").val(),
            month2: k.find("[name = month2] :selected").val(),
            year2: k.find("[name = year2]").val(),
            amount: k.find("[name = amount]").val()
        };
    }

    const forgivedesc = function (k) {
        if (k.value !== "")
            k.parentElement.style.border = "2px solid #c7a800";

        if (k.value.includes(";"))
            k.style.removeProperty("color");
    }

    const forgivewt = function (k) {
        if (!k.options[k.selectedIndex].value.includes("$"))
            k.style.removeProperty("color");
    }

    function wrapperf1(k) {
        //fix
        let regex = /^0+/;
        if (k.value.match(regex)) {
            let caret = k.selectionStart === 0 ? 0 : k.selectionStart - 1;
            k.value = k.value.replace(regex, '');
            k.selectionStart = k.selectionEnd = caret;
        }

        if (!/^([1-9][0-9]*)?$/.test(k.value))
            [k.value, k.selectionEnd, k.selectionStart] = JSON.parse(k.dirName);

        if (k.value !== "")
            k.parentElement.style.border = "2px solid #c7a800";
    }

    const forgivef2 = function (k) {
        if (!k.options[k.selectedIndex].value.includes("$"))
            k.style.removeProperty("color");
    }

    const adaptdate = function (k) {
        if (k.options[k.selectedIndex].value === "eom") {
            $('#' + k.id[0] + '0').hide(1200);
            $('#' + k.id[0] + '1').show(1200);
        } else if (k.options[k.selectedIndex].value === "eoy") {
            $('#' + k.id[0] + '0').hide(1200);
            $('#' + k.id[0] + '1').hide(1200);
        } else {
            $('#' + k.id[0] + '0').show(1200);
            $('#' + k.id[0] + '1').show(1200);
        }
    }
    const forgiveday = function (k) {
        if (!k.options[k.selectedIndex].value.includes("$"))
            k.style.removeProperty("color");
    }

    const wrappermonth = function (k) {
        if (!k.options[k.selectedIndex].value.includes("$"))
            k.style.removeProperty("color");
        setdays(k);
    }

    const wrapperyear = function (k) {
        let invalid = true;

        //fix
        let regex = /^()0+(0)/;
        if (k.value.match(regex)) {
            let caret = k.selectionStart === 0 ? 0 : k.selectionStart - 1;
            if (caret === 0 && k.value[0] === "-")
                caret += 1;
            k.value = k.value.replace(regex, '$1$2');
            k.selectionStart = k.selectionEnd = caret;
        }

        regex = /^(-)0+()/;
        if (k.value.match(regex)) {
            let caret = k.selectionStart === 0 ? 0 : k.selectionStart - 1;
            if (caret === 0 && k.value[0] === "-")
                caret += 1;
            k.value = k.value.replace(regex, '$1$2');
            k.selectionStart = k.selectionEnd = caret;
        }

        //test
        if (/^(-?([1-9][0-9]*)?|0)$/.test(k.value))
            invalid = false;

        if (invalid)
            [k.value, k.selectionEnd, k.selectionStart] = JSON.parse(k.dirName);


        //forgive
        if (k.value !== "")
            k.parentElement.style.border = "2px solid #c7a800";

        if (k.value !== "-")
            k.style.removeProperty("color");

        setdays(k);
    }

    const wrapperamount = function (k) {
        let invalid = true;

        //fix
        let regex = /^(-?)0+(0\.[0-9]*)/;
        if (k.value.match(regex)) {
            let caret = k.selectionStart === 0 ? 0 : k.selectionStart - 1;
            if (caret === 0 && k.value[0] === "-")
                caret += 1;
            k.value = k.value.replace(regex, '$1$2');
            k.selectionStart = k.selectionEnd = caret;
        }

        regex = /^(-?)0+([1-9][0-9]*\.[0-9]*)/;
        if (k.value.match(regex)) {
            let caret = k.selectionStart === 0 ? 0 : k.selectionStart - 1;
            if (caret === 0 && k.value[0] === "-")
                caret += 1;
            k.value = k.value.replace(regex, '$1$2');
            k.selectionStart = k.selectionEnd = caret;
        }

        regex = /^(-?)0+(0[1-9][0-9]*$)/;
        if (k.value.match(regex)) {
            let caret = k.selectionStart === 0 ? 0 : k.selectionStart - 1;
            if (caret === 0 && k.value[0] === "-")
                caret += 1;
            k.value = k.value.replace(regex, '$1$2');
            k.selectionStart = k.selectionEnd = caret;
        }

        regex = /^(-?)0+(0)$/;
        if (k.value.match(regex)) {
            let caret = k.selectionStart === 0 ? 0 : k.selectionStart - 1;
            if (caret === 0 && k.value[0] === "-")
                caret += 1;
            k.value = k.value.replace(regex, '$1$2');
            k.selectionStart = k.selectionEnd = caret;
        }

        let pos = k.value.indexOf(".");
        if (pos > -1 && !JSON.parse(k.dirName)[0].includes(".")) {
            let caret = k.selectionStart;
            if (k.value[0] === "-") {
                if (pos === 1) {
                    k.value = "-0" + k.value.slice(1, pos + 3);
                    k.selectionStart = k.selectionEnd = 3;
                } else {
                    k.value = k.value.slice(0, pos + 3);
                    k.selectionStart = k.selectionEnd = caret;
                }
            } else {
                if (pos === 0) {
                    k.value = "0" + k.value.slice(0, pos + 3);
                    k.selectionStart = k.selectionEnd = 2;
                } else {
                    k.value = k.value.slice(0, pos + 3);
                    k.selectionStart = k.selectionEnd = caret;
                }
            }
        }

        //test
        if (/^(-?[0-9]*\.?[0-9]?[0-9]?)$/.test(k.value))
            invalid = false;

        if (invalid)
            [k.value, k.selectionEnd, k.selectionStart] = JSON.parse(k.dirName);

        //forgive
        if (k.value !== "")
            k.parentElement.style.border = "2px solid #c7a800";

        if (!isNaN(k.value))
            k.style.removeProperty("color");

        if (Number(k.value) !== 0)
            k.style.removeProperty("color");

    }

    const setdays = function (k) {

        let day;
        let month;
        let year;

        if (parseInt(k.id.slice(1)) % 3 === 0) { //day
            day = k;
            month = document.getElementById(k.id[0] + (parseInt(k.id.slice(1)) + 1))
            year = document.getElementById(k.id[0] + (parseInt(k.id.slice(1)) + 2))
        }

        if (parseInt(k.id.slice(1)) % 3 === 1) { //month
            day = document.getElementById(k.id[0] + (parseInt(k.id.slice(1)) - 1))
            month = k;
            year = document.getElementById(k.id[0] + (parseInt(k.id.slice(1)) + 1))
        }

        if (parseInt(k.id.slice(1)) % 3 === 2) { //year
            day = document.getElementById(k.id[0] + (parseInt(k.id.slice(1)) - 2))
            month = document.getElementById(k.id[0] + (parseInt(k.id.slice(1)) - 1))
            year = k;
        }


        let currday = day.options[day.selectedIndex].value;
        let res = undefined;

        if (month.options[month.selectedIndex].value !== "$") {
            let yyear = 2004;
            if (year.value !== "" && year.value !== "-")
                yyear = year.value;
            res = new Date(yyear, month.options[month.selectedIndex].value, 0);
            res = res.getDate();
        } else
            res = 31;


        day.innerText = null;
        let el = $("#" + day.id);

        el.append("<option value=\"$\">--Please Select--</option>");
        let i = 1;
        for (i = 1; i <= res; i++)
            el.append("<option style=\"color : black\" value=\"" + i + "\">" + i + "</option>");

        el.find("[value = '" + currday + "']").prop('selected', true);
    }

    function check1(el) {
        let flag = 0;
        if (el.val() === "") {
            el.parent().css("border", "2px solid red");
            flag++;
        }
        return flag;
    }

    function check2(el) {
        let flag = 0;
        if (el.val().includes(";")) {
            el.css("color", "red");
            flag++;
        }
        return flag;
    }

    function check3(el) {
        let flag = 0;
        if (el.find(":selected").val().includes("$")) {
            el.css("color", "red");
            flag++;
        }
        return flag;
    }

    function check4(el) {
        let flag = 0;
        if (isNaN(el.val())) {
            el.css("color", "red");
            flag++;
        }
        return flag;
    }

    function check5(el) {
        let flag = 0;
        if (Number(el.val()) === 0) {
            el.css("color", "red");
            flag++;
        }
        return flag;
    }

</script>

<!-- CALLS TO SERVER -->
<script>
    function _delete(_id) {
        $.post("/delete", {data: _id}, function (returnedData) {
            $("#" + _id).remove();
            console.log(returnedData)
        }).fail(function () {
            console.log("error")
        })
    }

    function duplicate(_id) {
        $.post("/duplicate", {data: _id}, function (returnedData) {
            populate1();
            console.log(returnedData)
        }).fail(function () {
            console.log("error")
        })
    }

    function addnews() {
        let el = $("#singleordernew");
        let flag = 0;

        //CHECKS
        flag += check1(el.find("[name = descr]"));
        flag += check2(el.find("[name = descr]"));
        flag += check3(el.find("[name = wt]"));
        flag += check3(el.find("[name = day]"));
        flag += check3(el.find("[name = month]"));
        flag += check1(el.find("[name = year]"));
        flag += check4(el.find("[name = year]"));
        flag += check1(el.find("[name = amount]"));
        flag += check4(el.find("[name = amount]"));
        flag += check5(el.find("[name = amount]"));


        if (flag > 0)
            return;

        el.find("[name = amount]").val(parseFloat(el.find("[name = amount]").val()).toFixed(2));
        $.post("/addnew", {data: JSON.stringify(preparetosend(el))}, function (returnedData) {
            el.find("[name = descr]").val("")
            el.find("[name = wt]").val("$")
            el.find("[name = year]").val("")
            el.find("[name = month]").val("$")
            el.find("[name = day]").val("$");
            setdays(el.find("[name = day]")[0]);
            el.find("[name = amount]").val("");

            populate1();

            console.log(returnedData)
        }).fail(function () {
            console.log("error")
        })
    }

    function addnewr() {
        let el = $("#repeatedordernew");
        let flag = 0;

        if (el.find("[name = f2] :selected").val() === "months" && el.find("[name = f1]").val() % 12 === 0) {
            el.find("[name = f2]").val('years');
            el.find("[name = f1]").val(el.find("[name = f1]").val() / 12);
        }

        //CHECKS
        flag += check1(el.find("[name = descr]"));
        flag += check2(el.find("[name = descr]"));
        flag += check3(el.find("[name = wt]"));
        flag += check1(el.find("[name = f1]"));
        flag += check3(el.find("[name = f2]"));
        flag += check1(el.find("[name = amount]"));
        flag += check4(el.find("[name = amount]"));
        flag += check5(el.find("[name = amount]"));

        if (el.find("[name = opt1] :selected").val() === "default") {
            flag += check3(el.find("[name = day1]"));
            flag += check3(el.find("[name = month1]"));
            flag += check1(el.find("[name = year1]"));
            flag += check4(el.find("[name = year1]"));
        } else if (el.find("[name = opt1] :selected").val() === "eom") {
            if (el.find("[name = f2] :selected").val() === "days") {
                el.find("[name = opt1]").css("color", "red");
                el.find("[name = f2]").css("color", "red");
                flag++;
            }
            flag += check3(el.find("[name = month1]"));
            flag += check1(el.find("[name = year1]"));
            flag += check4(el.find("[name = year1]"));
        } else if (el.find("[name = opt1] :selected").val() === "eoy") {
            if (el.find("[name = f2] :selected").val() !== "years") {
                el.find("[name = opt1]").css("color", "red");
                el.find("[name = f2]").css("color", "red");
                flag++;
            }
            flag += check1(el.find("[name = year1]"));
            flag += check4(el.find("[name = year1]"));
        }

        if (!(el.find("[name = day2] :selected").val() === "$" &&
            el.find("[name = month2] :selected").val() === "$" &&
            el.find("[name = year2]").val() === "")) {
            if (el.find("[name = opt2] :selected").val() === "default") {
                flag += check3(el.find("[name = day2]"));
                flag += check3(el.find("[name = month2]"));
                flag += check1(el.find("[name = year2]"));
                flag += check4(el.find("[name = year2]"));
            } else if (el.find("[name = opt2] :selected").val() === "eom") {
                flag += check3(el.find("[name = month2]"));
                flag += check1(el.find("[name = year2]"));
                flag += check4(el.find("[name = year2]"));
            } else if (el.find("[name = opt2] :selected").val() === "eoy") {
                flag += check1(el.find("[name = year2]"));
                flag += check4(el.find("[name = year2]"));
            }
        }

        if (flag > 0)
            return;

        el.find("[name = amount]").val(parseFloat(el.find("[name = amount]").val()).toFixed(2));
        $.post("/addnew", {data: JSON.stringify(preparetosend(el))}, function (returnedData) {
            el.find("[name = descr]").val("");
            el.find("[name = wt]").val("$");
            el.find("[name = f1]").val("");
            el.find("[name = f2]").val("$");

            el.find("[name = opt1]").val("default");
            adaptdate(el.find("[name = opt1]")[0]);
            el.find("[name = year1]").val("");
            el.find("[name = month1]").val("$");
            el.find("[name = day1]").val("$");
            setdays(el.find("[name = day1]")[0]);

            el.find("[name = opt2]").val("default");
            adaptdate(el.find("[name = opt2]")[0]);
            el.find("[name = year2]").val("");
            el.find("[name = month2]").val("$");
            el.find("[name = day2]").val("$");
            setdays(el.find("[name = day2]")[0]);

            el.find("[name = amount]").val("");

            populate1();

            console.log(returnedData)
        }).fail(function () {
            console.log("error")
        })
    }

    function haltprocessor() {
        $.post("/haltprocessor")
    }
</script>


</html>

